(this["webpackJsonpmovies-app"]=this["webpackJsonpmovies-app"]||[]).push([[0],{18:function(e){e.exports=JSON.parse('{"a":"http://localhost:3900/api/","b":"x-auth-token"}')},48:function(e,t,a){e.exports=a(94)},53:function(e,t,a){},80:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(43),s=a.n(o),i=(a(53),a(10)),c=a(6),l=a(7),u=a(9),m=a(8),v=(n.Component,a(1)),d=a.n(v),p=a(3),h=a(19),f=a.n(h),b=a(18);f.a.interceptors.response.use((function(e){var t=e.config.url,a=!1;return["/api/users/","/api/auth/"].every((function(e){if(t.indexOf(e)>-1)return a=!0})),a?Promise.resolve(e):Promise.resolve(e.data)}),(function(e){return Promise.reject(e)}));var g={get:f.a.get,put:f.a.put,delete:f.a.delete,patch:f.a.patch,post:f.a.post,setToken:function(e){f.a.defaults.headers.common[b.b]=e},is404Ex:function(e){return e&&e.response&&404===e.response.status},is400Ex:function(e){return e&&e.response&&400===e.response.status}},k=a(44),E=a.n(k),y=b.a+"auth/";function w(){return(w=Object(p.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.post(y,{email:t,password:a});case 2:(n=e.sent)&&localStorage.setItem("token",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("token",t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return localStorage.getItem("token")}g.setToken(N());var x={login:function(e,t){return w.apply(this,arguments)},logout:function(e){localStorage.removeItem("token")},getCurrentUser:function(){try{var e=localStorage.getItem("token");return E()(e)}catch(t){return null}},loginWithToken:function(e){return C.apply(this,arguments)},getToken:N},S=b.a+"users/";function O(){return(O=Object(p.a)(d.a.mark((function e(t){var a,n,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.password,r=t.name,e.next=3,g.post(S,{email:a,password:n,name:r});case 3:return o=e.sent,e.abrupt("return",o.headers["x-auth-token"]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j={register:function(e){return O.apply(this,arguments)}},P=a(12),M=a(14),I=a.n(M),R=b.a+"movies/",L=function(e){return"".concat(R,"/").concat(e)};function q(){return g.get(R)}function D(){return(D=Object(p.a)(d.a.mark((function e(t,a,n,r){var o,s,i,c,l,u,m,v=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=v.length>4&&void 0!==v[4]?v[4]:[],s=v.length>5&&void 0!==v[5]?v[5]:[],i=v.length>6?v[6]:void 0,c=(t-1)*a,l=0,e.next=7,q();case 7:return u=e.sent,m=I.a.chain(u).filter((function(e){return(null==n||n<=0||e.genre._id===n)&&(null==i||e.title.toLocaleLowerCase().indexOf(i.toLocaleLowerCase())>=0)&&s.indexOf(e)<0})).orderBy([null===r||void 0===r?void 0:r.path],[null===r||void 0===r?void 0:r.order]).tap((function(e){e.forEach((function(e){o.indexOf(e)>=0&&(e.liked=!0)})),l=e.length})).slice(c).take(a).value(),e.abrupt("return",{movies:m,totalCount:l});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){return g.get(L(e))}function T(e){return _.apply(this,arguments)}function _(){return(_=Object(p.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._id){e.next=7;break}return a=t._id,delete(n=Object(P.a)({},t))._id,e.abrupt("return",g.put(L(a),n));case 7:return e.abrupt("return",g.post(R,t));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U={deleteMovie:function(e){return g.delete(L(e))},getMovie:G,getMovies:q,saveMovie:T,searchMovies:function(e,t,a,n){return D.apply(this,arguments)}},z=b.a+"genres/";var A={getGenre:function(e){return g.get(function(e){return"".concat(z,"/").concat(e)}(e))},getGenres:function(){return g.get(z)}};var F=function(e){var t=e.user;return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light mb-4"},r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(i.c,{className:"nav-link nav-item",to:"/"},"Home"),r.a.createElement(i.c,{className:"nav-link nav-item",to:"/movies"},"Movies"),r.a.createElement(i.c,{className:"nav-link nav-item",to:"/customers"},"Customers"),r.a.createElement(i.c,{className:"nav-link nav-item",to:"/rentals"},"Rentals")),r.a.createElement("div",{className:"navbar-nav ml-auto nav-flex-icons"},!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.c,{className:"nav-link nav-item",to:"/login"},"Login"),r.a.createElement(i.c,{className:"nav-link nav-item",to:"/register"},"Register")),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"#",onClick:function(e){return function(e){e.preventDefault(),x.logout(),window.location="/"}(e)},className:"nav-link nav-item"},"Logout"),r.a.createElement("div",{className:"user-profile"},r.a.createElement("span",{className:"name"},t.name),r.a.createElement("span",{className:"icon"}))))))},B=a(22),W=a(20),J=a(46),Z=function(e){return r.a.createElement(B.a,{className:"cursor-pointer",title:e.liked?"Unlike":"Like",onClick:function(){return e.onClick()},icon:e.liked?W.a:J.a})},$=function e(t){var a=t.items,n=t.textProperty,o=t.valueProperty,s=t.onItemSelect,i=t.orderProperty,c=t.selectedItem,l=function(e){return(c&&e[o]===c[o]?"active ":"")+"list-group-item"};return r.a.createElement("ul",{className:"list-group"},I()(a).orderBy([i]).map((function(t){var a=t[n],i=t[o];if(!a||!i)throw Error("".concat(typeof e," must have a valid name & id props."));return r.a.createElement("li",{className:l(t),key:i,onClick:function(){return s(t)}},a)})).value())};$.defaultProps={textProperty:"name",valueProperty:"_id",orderProperty:"order",items:[]};var H=$,K=function(){return r.a.createElement("h1",null,"Page Not Found!")},Q=function(e){var t=e.sort,a=e.path;return r.a.createElement(B.a,{className:t.path===a?"":"d-none",icon:"asc"===t.order?W.c:W.b})},V=a(25),X=a(11),Y=a.n(X),ee=a(23),te=function(e){var t=e.error,a=e.name,n=e.label,o=Object(ee.a)(e,["error","name","label"]);return r.a.createElement("div",{className:"form-group"},n&&r.a.createElement("label",{htmlFor:a},n),r.a.createElement("input",Object.assign({},o,{name:a,className:"form-control"})),t&&r.a.createElement("div",{className:"alert alert-danger"},t))};te.defaultProps={type:"text"};var ae=te,ne=function(e){var t=e.options,a=e.error,n=e.name,o=e.label,s=Object(ee.a)(e,["options","error","name","label"]);return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:n},o),r.a.createElement("select",Object.assign({},s,{name:n,className:"form-control"}),r.a.createElement("option",{value:""}),t.map((function(e){return r.a.createElement("option",{key:e._id,value:e._id},e.name)}))),a&&r.a.createElement("div",{className:"alert alert-danger"},a))},re=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{},errors:{}},e.validate=function(){var t=Y.a.validate(e.state.data,e.schema,{abortEarly:!1}).error;if(!t)return null;var a={};return t.details.forEach((function(e){return a[e.path[0]]=e.message})),a},e.handleSubmit=function(t){t.preventDefault();var a=e.validate();e.setState({errors:a||{}}),a&&a.length||e.submit()},e.handleChange=function(t){var a=t.currentTarget,n=a.name,r=a.value,o=Object(P.a)({},e.state.errors),s=e.validateProperty(a);s?o[a.name]=s:delete o[a.name];var i=Object(P.a)({},e.state.data);i[n]=r,e.setState({data:i,errors:o})},e.handleClear=function(t){t.preventDefault();var a=e.state.data;I.a.forEach(a,(function(e,t){a[t]=""})),e.setState({data:a,errors:{}})},e}return Object(l.a)(a,[{key:"validateProperty",value:function(e){var t=e.name,a=e.value,n=Object(V.a)({},t,a),r=Object(V.a)({},t,this.schema[t]),o=Y.a.validate(n,r).error;return o?o.details[0].message:null}},{key:"renderInput",value:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",o=this.state.data;return r.a.createElement(ae,{value:o[e],onChange:function(e){return a.handleChange(e)},name:e,label:t,id:e,type:n,error:this.state.errors[e]})}},{key:"renderSelect",value:function(e,t,a){var n=this.state,o=n.errors,s=n.data;return r.a.createElement(ne,{options:a,value:s[e],onChange:this.handleChange,name:e,label:t,error:o[e]})}},{key:"renderSubmitButton",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Submit";return r.a.createElement("button",{disabled:this.validate(),className:"btn btn-primary mr-4",onClick:function(t){return e.handleSubmit(t)}},t)}}]),a}(n.Component),oe=function(e){var t=e.value,a=e.onChange,n=e.className;return r.a.createElement("input",{type:"text",label:"Search",placeholder:"Search...",name:"query",value:t,className:"form-control "+n,onChange:function(e){return a(e.currentTarget.value)}})},se=function(e){var t=e.columns,a=e.sort,n=e.onSort;return r.a.createElement("thead",null,r.a.createElement("tr",null,t.map((function(e){var t=e.path,o=e.title,s=e.key;return o?r.a.createElement("th",{key:s||t,className:"cursor-pointer",onClick:function(){return function(e){var t=a&&e===a.path&&"asc"===a.order?"desc":"asc";n({path:e,order:t})}(t)}},r.a.createElement("span",null,o),r.a.createElement(Q,{sort:a,path:t})):r.a.createElement("th",{key:s||t})}))))},ie=function(e){var t=e.data,a=e.columns;return r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement("tr",{key:e.key||t},a.map((function(t){return r.a.createElement("td",{key:t.path||t.key},function(e,t){var a=t.path,n=t.content;return n?n(e):I.a.get(e,a)}(e,t))})))})))},ce=a(2),le=a.n(ce);se.propTypes={sort:le.a.object.isRequired,onSort:le.a.func.isRequired,columns:le.a.array.isRequired};var ue=function(e){var t=e.columns,a=e.data,n=e.onSort,o=e.onDelete,s=e.onLike,i=e.sort;return r.a.createElement("table",{className:"table"},r.a.createElement(se,{sort:i,columns:t,onSort:function(e){return n(e)}}),r.a.createElement(ie,{data:a,columns:t,onDelete:function(e){return o(e)},onLike:function(e){return s(e)}}))},me=(a(80),function(e){var t=e.activePageNumber,a=e.totalCount,n=e.pageSize,o=e.onPageChange,s=Math.ceil(a/n),i=I.a.range(1,s+1),c=function(e){return(e===t?"active ":"")+"page-item cursor-pointer"};return r.a.createElement("nav",{className:"d-flex align-items-center justify-content-between"},r.a.createElement("ul",{className:"pagination"},r.a.createElement("li",{className:"page-item cursor-pointer",disabled:1===t,onClick:function(){return o(t-1)}},r.a.createElement("button",{className:"page-link"},"Previous")),i.map((function(e){return r.a.createElement("li",{key:e,disabled:t===e,className:c(e),onClick:function(){return o(e)}},r.a.createElement("button",{className:"page-link"},e))})),r.a.createElement("li",{className:"page-item cursor-pointer",disabled:t===s,onClick:function(){return o(t+1)}},r.a.createElement("button",{className:"page-link"},"Next"))),r.a.createElement("span",null,"Total items ",t*n>a?a:t*n," of ",a))}),ve=a(4),de=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).schema={username:Y.a.string().required().label("UserName"),password:Y.a.string().required().label("Password")},e.state={data:{username:"",password:""},errors:{}},e}return Object(l.a)(a,[{key:"submit",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,a,n,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.data,a=t.username,n=t.password,e.prev=1,e.next=4,x.login(a,n);case 4:r=this.props.location.state,window.location=r?r.from.pathname:"/",e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),g.is400Ex(e.t0)&&((o=Object(P.a)({},this.state.errors)).form=e.t0.response.data,this.setState({errors:o}));case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n=this;if(x.getCurrentUser())return r.a.createElement(ve.a,{to:"/"});var o=this.state.data;return r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),r.a.createElement("form",{action:""},r.a.createElement(ae,{value:o.username,onChange:function(e){return n.handleChange(e)},name:"username",label:"User Name",id:"username",error:null===(e=this.state.errors)||void 0===e?void 0:e.username}),r.a.createElement(ae,{value:o.password,onChange:function(e){return n.handleChange(e)},name:"password",label:"Password",id:"password",type:"password",error:null===(t=this.state.errors)||void 0===t?void 0:t.password}),(null===(a=this.state.errors)||void 0===a?void 0:a.form)&&r.a.createElement("div",{className:"alert alert-danger"},this.state.errors.form),r.a.createElement("button",{disabled:this.validate(),className:"btn btn-primary mr-4",onClick:function(e){return n.handleSubmit(e)}},"Login"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(e){return n.handleClear(e)}},"Clear")))}}]),a}(re),pe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).schema={username:Y.a.string().email().required().label("UserName").regex(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),password:Y.a.string().min(8).max(16).required().label("Password"),name:Y.a.string().required().label("Name")},e.state={data:{username:"",password:"",name:""},errors:{}},e}return Object(l.a)(a,[{key:"submit",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.register(this.state.data);case 3:t=e.sent,x.loginWithToken(t),window.location="/",e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g.is400Ex(e.t0)&&((a=Object(P.a)({},this.state.errors)).form=e.t0.response.data,this.setState({errors:a}));case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){x.getCurrentUser()&&this.props.history.replace("/")}},{key:"render",value:function(){var e,t,a,n,o=this,s=this.state.data;return r.a.createElement("div",null,r.a.createElement("h1",null,"Register"),r.a.createElement("form",{action:""},r.a.createElement(ae,{value:s.username,onChange:function(e){return o.handleChange(e)},name:"username",label:"User Name",id:"username",error:null===(e=this.state.errors)||void 0===e?void 0:e.username}),r.a.createElement(ae,{value:s.password,onChange:function(e){return o.handleChange(e)},name:"password",label:"Password",id:"password",type:"password",error:null===(t=this.state.errors)||void 0===t?void 0:t.password}),r.a.createElement(ae,{value:s.name,onChange:function(e){return o.handleChange(e)},name:"name",label:"Name",id:"name",error:null===(a=this.state.errors)||void 0===a?void 0:a.name}),(null===(n=this.state.errors)||void 0===n?void 0:n.form)&&r.a.createElement("div",{className:"alert alert-danger"},this.state.errors.form),r.a.createElement("button",{disabled:this.validate(),className:"btn btn-primary mr-4",onClick:function(e){return o.handleSubmit(e)}},"Register"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(e){return o.handleClear(e)}},"Clear")))}}]),a}(re),he=(n.Component,a(47)),fe=a.n(he),be=function(e){var t=e.totalCount,a=e.movies,n=e.sort,o=e.onLike,s=e.onDelete,c=e.onSort,l=[{key:"title",path:"title",title:"Title",content:function(e){var t=e._id,a=e.title,n="/movies/".concat(t);return r.a.createElement(i.b,{to:n},a)}},{path:"genre.name",title:"Genre"},{path:"numberInStock",title:"Stock"},{path:"dailyRentalRate",title:"Rate"},{key:"like",content:function(e){return r.a.createElement(Z,{liked:e.liked,onClick:function(){return o(e)}})}},{key:"delete",content:function(e){return r.a.createElement("button",{title:"Delete",onClick:function(){return s(e)},className:"btn btn-danger btn-sm"},r.a.createElement(B.a,{icon:W.d}))}}],u=x.getCurrentUser();return u&&u.isAdmin||I.a.remove(l,(function(e){return"delete"===e.key})),r.a.createElement("div",null,r.a.createElement("p",null,"Showing ",t," movies in the database."),r.a.createElement(ue,{data:a,sort:n,columns:l,onSort:function(e){return c(e)},onDelete:function(e){return s(e)},onLike:function(e){return o(e)}}))},ge=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).movies=[],e.genres=[],e.pageSize=5,e.state={movies:[],totalCount:0,pageSize:e.pageSize,activePageNumber:1,query:"",selectedGenre:null,sort:{path:"title",order:"asc"},liked:[],deleted:[]},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,a,n,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getGenres();case 2:return t=e.sent,a=fe.a.parse(this.props.location.search),n=t.find((function(e){return a.genre&&e.name.toLowerCase()===a.genre.toLowerCase()})),r=n||t[0],e.next=8,U.searchMovies(1,this.pageSize,r._id);case 8:o=e.sent,this.setState({movies:o.movies,totalCount:o.totalCount,genres:t,selectedGenre:r});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.movies,n=t.totalCount,o=t.genres,s=t.selectedGenre,c=t.activePageNumber,l=t.pageSize,u=t.sort,m=t.query,v=this.props.user;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement(H,{selectedItem:s,items:o,onItemSelect:function(t){return e.handleGenreSelect(t)}})),r.a.createElement("div",{className:"col-8"},v&&v.isAdmin&&r.a.createElement(i.b,{className:"btn btn-primary",to:"/movies/new"},"New Movie"),r.a.createElement(oe,{className:"my-4",onChange:function(t){return e.handleSearch(t)},value:m}),a&&a.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{totalCount:n,sort:u,movies:a,onSort:function(t){return e.handleSort(t)},onLike:function(t){return e.handleLike(t)},onDelete:function(t){return e.handleDelete(t)}}),r.a.createElement(me,{pageSize:l,totalCount:n,activePageNumber:c,onPageChange:function(t){return e.handlePageChange(t)}})):r.a.createElement("p",null,"No movies in the database")))}},{key:"handleSearch",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={query:t,selectedGenre:null,currentPage:1},e.next=3,this.searchMovies(a);case 3:n=e.sent,r=n.movies,o=n.totalCount,this.setState(Object(P.a)(Object(P.a)({},a),{},{movies:r,totalCount:o}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSort",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.searchMovies({sort:t});case 2:a=e.sent,n=a.movies,r=a.totalCount,this.setState({movies:n,totalCount:r,sort:t});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleGenreSelect",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.history.push({search:"?genre=".concat(t.name.toLowerCase())}),e.next=3,this.searchMovies({selectedGenre:t,activePageNumber:1});case 3:a=e.sent,n=a.movies,r=a.totalCount,this.setState({movies:n,totalCount:r,selectedGenre:t,activePageNumber:1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handlePageChange",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.searchMovies({activePageNumber:t});case 2:a=e.sent,n=a.movies,r=a.totalCount,this.setState({movies:n,totalCount:r,activePageNumber:t});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleDelete",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.deleteMovie(t._id);case 2:return e.next=4,this.searchMovies();case 4:a=e.sent,n=a.movies,r=a.totalCount,this.setState({movies:n,totalCount:r});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleLike",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.toggleLikeMovie(t);case 2:return e.next=4,this.searchMovies();case 4:a=e.sent,n=a.movies,r=a.totalCount,this.setState({movies:n,totalCount:r});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchMovies",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r,o,s,i,c,l,u,m,v;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(P.a)(Object(P.a)({},this.state),t),n=a.selectedGenre,r=a.activePageNumber,o=a.pageSize,s=a.sort,i=a.liked,c=a.deleted,l=a.query,e.next=3,U.searchMovies(r,o,null===n||void 0===n?void 0:n._id,s,i,c,l);case 3:return u=e.sent,m=u.movies,v=u.totalCount,e.abrupt("return",{movies:m,totalCount:v});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(n.Component),ke=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{title:"",genreId:"",numberInStock:"",dailyRentalRate:""},genres:[],errors:{}},e.schema={_id:Y.a.string(),title:Y.a.string().required().label("Title"),genreId:Y.a.string().required().label("Genre"),numberInStock:Y.a.number().min(0).max(100).required().label("Number In Stock"),dailyRentalRate:Y.a.number().min(0).max(10).required().label("Daily Rental Rate")},e.submit=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U.saveMovie(e.state.data);case 2:e.props.history.push("/movies");case 3:case"end":return t.stop()}}),t)}))),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getGenres();case 2:if(t=e.sent,this.setState({genres:t}),"new"!==(a=this.props.match.params.id)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,U.getMovie(a);case 9:if(n=e.sent){e.next=12;break}return e.abrupt("return",this.props.history.replace("/not-found"));case 12:this.setState({data:this.mapToMovieModel(n)});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("h1",null,"New Movie"),r.a.createElement("form",{action:""},this.renderInput("title","Title"),this.renderSelect("genreId","Genre",this.state.genres),this.renderInput("numberInStock","Number In Stock","number"),this.renderInput("dailyRentalRate","Daily Rental Rate","number"),r.a.createElement("button",{disabled:this.validate(),className:"btn btn-primary mr-4",onClick:function(t){return e.handleSubmit(t)}},"Save"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(t){return e.handleClear(t)}},"Clear")))}},{key:"mapToMovieModel",value:function(e){return{_id:e._id,title:e.title,genreId:e.genre._id,numberInStock:e.numberInStock,dailyRentalRate:e.dailyRentalRate}}}]),a}(re),Ee=function(e){var t=e.component,a=e.render,n=Object(ee.a)(e,["component","render"]);return r.a.createElement(ve.b,Object.assign({},n,{render:function(n){return x.getCurrentUser()?t?r.a.createElement(t,n):a(n):r.a.createElement(ve.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},ye=function(e){return r.a.createElement(ve.d,null,r.a.createElement(ve.b,{path:"/login",render:function(e){return r.a.createElement(de,e)}}),r.a.createElement(ve.b,{path:"/register",render:function(e){return r.a.createElement(pe,e)}}),r.a.createElement(Ee,{path:"/movies/:id",component:ke}),r.a.createElement(ve.b,{path:"/movies",render:function(t){return r.a.createElement(ge,Object.assign({},t,{user:e.user}))}}),r.a.createElement(ve.b,{path:"/no-found",component:K}),r.a.createElement(ve.a,{from:"/",exact:!0,to:"/movies"}),r.a.createElement(ve.a,{to:"/no-found"}))},we=(a(93),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={user:null},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=x.getCurrentUser();this.setState({user:e})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{user:this.state.user}),r.a.createElement("div",{className:"container"},r.a.createElement(ye,{user:this.state.user})))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,null,r.a.createElement(we,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.3f7d201a.chunk.js.map